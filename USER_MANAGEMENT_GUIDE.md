# Руководство по управлению пользователями CRM системы

## Обзор системы

Система управления пользователями позволяет администраторам управлять клиентами биржи SaleBit. После регистрации новые пользователи получают статус "Ожидающий" и должны быть одобрены администратором для получения полного доступа к системе.

## Статусы пользователей

### 1. Ожидающий (pending)
- **Описание**: Новые пользователи после регистрации
- **Доступ**: Ограниченный доступ к дашборду
- **Действия**: Показывается сообщение о необходимости ожидания подтверждения

### 2. Активный (active)
- **Описание**: Подтвержденные пользователи
- **Доступ**: Полный доступ ко всем функциям
- **Действия**: Могут торговать и использовать все возможности

### 3. В проработке (processing)
- **Описание**: Пользователи, требующие дополнительной проверки
- **Доступ**: Ограниченный доступ
- **Действия**: Показывается сообщение о том, что аккаунт в обработке

### 4. Отклоненный (rejected)
- **Описание**: Пользователи, которым отказано в доступе
- **Доступ**: Нет доступа к системе
- **Действия**: Показывается сообщение об отклонении аккаунта

## Доступ к CRM

### Для администраторов
1. Войдите в систему с учетными данными администратора (AdminNKcoin)
2. На главной странице появится кнопка "Управление пользователями"
3. Перейдите на страницу `/User.html` для управления пользователями

### Для обычных пользователей
- CRM недоступна
- Пользователи видят только свой дашборд с информацией о статусе аккаунта

## Функции CRM

### Просмотр пользователей
- **Таблица пользователей**: Отображает всех зарегистрированных пользователей
- **Фильтрация**: По статусу (активные, ожидающие, отклоненные, в проработке)
- **Поиск**: По имени пользователя или email
- **Сортировка**: По дате регистрации, имени, email, статусу

### Статистика
- **Всего пользователей**: Общее количество зарегистрированных пользователей
- **Активные**: Количество активных пользователей
- **Ожидающие**: Количество пользователей на рассмотрении
- **Отклоненные**: Количество отклоненных пользователей

### Управление пользователями

#### Добавление нового пользователя
1. Нажмите кнопку "Добавить пользователя"
2. Заполните форму:
   - Имя пользователя
   - Email
   - Пароль
   - Статус
   - Заметки (опционально)
3. Нажмите "Добавить пользователя"

#### Редактирование пользователя
1. Нажмите кнопку "Редактировать" в строке пользователя
2. Измените необходимые поля:
   - Имя пользователя
   - Email
   - Статус
   - Баланс USD
   - Заметки
3. Нажмите "Сохранить изменения"

#### Удаление пользователя
1. Нажмите кнопку "Удалить" в строке пользователя
2. Подтвердите удаление
3. **Внимание**: Администратор не может быть удален

## Процесс регистрации и одобрения

### 1. Регистрация пользователя
- Пользователь регистрируется на главной странице
- Система автоматически устанавливает статус "Ожидающий"
- Пользователь получает уведомление о необходимости ожидания подтверждения

### 2. Рассмотрение администратором
- Администратор видит нового пользователя в списке
- Может изменить статус на:
  - **Активный** - для одобрения
  - **В проработке** - для дополнительной проверки
  - **Отклоненный** - для отказа

### 3. Уведомления пользователя
- При входе в систему пользователь видит статус своего аккаунта
- Сообщения автоматически показываются в зависимости от статуса

## Безопасность

### Проверка прав доступа
- Только администраторы (AdminNKcoin) могут получить доступ к CRM
- Все API endpoints защищены проверкой JWT токена
- Проверяется роль пользователя перед выполнением операций

### Защита данных
- Пароли хешируются с использованием bcrypt
- JWT токены имеют ограниченное время жизни (24 часа)
- Все запросы к API требуют авторизации

## Навигация

### Переход между страницами
- **Монеты**: `/coin.html` - управление криптовалютами
- **Пользователи**: `/User.html` - управление пользователями
- **Главная**: `/` - дашборд и авторизация

### Навигационное меню
- Доступно на страницах монет и пользователей
- Показывает текущую активную страницу
- Позволяет быстро переключаться между разделами

## Устранение неполадок

### Проблемы с доступом
1. Убедитесь, что вы вошли как администратор (AdminNKcoin)
2. Проверьте, что JWT токен не истек
3. Очистите кэш браузера при необходимости

### Проблемы с отображением данных
1. Нажмите кнопку "Обновить" для обновления данных
2. Проверьте подключение к интернету
3. Убедитесь, что сервер запущен

### Проблемы с базой данных
1. Проверьте, что файл `crypto_data.db` существует
2. Убедитесь, что у процесса есть права на запись
3. Проверьте логи сервера на наличие ошибок

## Технические детали

### База данных
- SQLite база данных (`crypto_data.db`)
- Таблица `users` содержит информацию о пользователях
- Поля: id, username, email, password, status, notes, lastLogin, createdAt

### API Endpoints
- `GET /api/users` - получение списка пользователей
- `POST /api/users` - создание нового пользователя
- `PUT /api/users/:id` - обновление пользователя
- `DELETE /api/users/:id` - удаление пользователя

### Фронтенд
- HTML5, CSS3, JavaScript (ES6+)
- Адаптивный дизайн
- Модальные окна для форм
- Уведомления в реальном времени
